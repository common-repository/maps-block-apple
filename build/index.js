(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var o in a)e.o(a,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:a[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{isAuthenticated:()=>n});var a={};e.r(a),e.d(a,{updateAuthenticationStatus:()=>s});const o=window.wp.blocks,l=window.wp.data,i=(0,l.combineReducers)({authenticationReducer:function(e,t){return"UPDATE_AUTHENTICATION"===t.type?{...e,authenticated:t.isAuthenticated}:e}});function n(e){return Boolean(e?.authenticationReducer?.authenticated)}function s(e){return{type:"UPDATE_AUTHENTICATION",isAuthenticated:e}}const r=(0,l.createReduxStore)("tenup/maps-block-apple",{reducer:i,selectors:t,actions:a});(0,l.register)(r);const p=window.React,c=window.wp.components,m=window.wp.i18n,d=window.wp.element,u=window.wp.compose,h=window.wp.blockEditor,b=window.wp.apiFetch;var g=e.n(b);class y{constructor(e){this.element=e,this.mapOptions={},this.markerElements=this.element.querySelectorAll(".marker-annotation"),this.markers=[...this.markerElements].map((e=>{const{latitude:t,longitude:a,title:o,subtitle:l,color:i,glyphColor:n,glyphImage:s}=e.dataset;return{latitude:Number(t),longitude:Number(a),title:o||"",subtitle:l||"",color:i||null,glyphColor:n||null,glyphImage:s||null}})),this.mapkit=e.ownerDocument.defaultView.mapkit,this.mapkit&&this.init()}init(){this.createMap(),this.addMarkers(this.markers)}createMap(){const{mapType:e,latitude:t,longitude:a,rotation:o,zoom:l,showsMapTypeControl:i=!0,isRotationEnabled:n=!0,showsCompass:s,isZoomEnabled:r=!0,showsZoomControl:p=!0,isScrollEnabled:c=!0,showsScale:m}=this.element.dataset,d=new this.mapkit.Coordinate(Number(t)||51.48762585296625,Number(a)||-.1326724377053381);this.mapOptions={center:d,rotation:Number(o)||0,mapType:e||this.mapkit.Map.MapTypes.Satellite,showsMapTypeControl:"true"===i,isRotationEnabled:"true"===n,isZoomEnabled:"true"===r,showsZoomControl:"true"===p,isScrollEnabled:"true"===c,showsScale:m||this.mapkit.FeatureVisibility.Adaptive},this.mapOptions.isRotationEnabled&&(this.mapOptions.showsCompass=s||this.mapkit.FeatureVisibility.Adaptive),this.map=new this.mapkit.Map(this.element,this.mapOptions),this.map._impl.zoomLevel=Number(l)||15}addMarkers(e){this.clearMarkers();const t=[];e.forEach(((a,o)=>{const{latitude:l,longitude:i,title:n,subtitle:s,titleVisibility:r,subtitleVisibility:p,color:c,glyphColor:m,glyphText:d,glyphImage:u}=a,h=new this.mapkit.Coordinate(Number(l),Number(i)),b={title:n,subtitle:s||null,titleVisibility:r||this.mapkit.FeatureVisibility.Visible,subtitleVisibility:p||this.mapkit.FeatureVisibility.Visible,color:c||"green",glyphColor:m||"white",glyphText:d||"",draggable:!!this.isEditor};u&&(b.glyphImage={1:u});const g=new this.mapkit.MarkerAnnotation(h,b);this.setAttributes&&g.addEventListener("drag-end",(t=>{const{target:{coordinate:a}}=t,l=[...e];l[o].latitude=a.latitude,l[o].longitude=a.longitude,this.setAttributes({markers:l})})),t.push(g)})),this.map.addAnnotations(t)}clearMarkers(){this.map.removeAnnotations(this.map.annotations)}static authenticateMap(e){g()({path:"MapsBlockApple/v1/GetJWT/"}).then((()=>{e.init({authorizationCallback(e){g()({path:"MapsBlockApple/v1/GetJWT/"}).then(e)}})})).catch((t=>{(0,l.dispatch)("core/notices").createErrorNotice(t.message,{isDismissible:!0,type:"snackbar"}),e.dispatchEvent(new Event("error"))}))}}class k extends y{constructor(e,t,a){super(e),this.isEditor=!0,this.clientId=t,this.setAttributes=a,this.initEdit()}initEdit(){this.addListeners(),this.addMarkers(this.markers)}destroy(){this.map&&this.map.destroy()}addListeners(){this.map.element.addEventListener("click",(()=>{(0,l.dispatch)("core/block-editor").selectBlock(this.clientId)})),this.map.addEventListener("map-type-change",(()=>{this.setAttributes({mapType:this.map.mapType})})),this.map.addEventListener("region-change-end",(()=>{this.setAttributes({rotation:this.map.rotation,latitude:this.map.center.latitude,longitude:this.map.center.longitude,zoom:this.map._impl.zoomLevel})}))}update(e){const{mapType:t,latitude:a,longitude:o,rotation:l,zoom:i,showsMapTypeControl:n,isRotationEnabled:s,showsCompass:r,isZoomEnabled:p,showsZoomControl:c,isScrollEnabled:m,showsScale:d,region:u,height:h}=e;h&&(this.element.style.height=`${h}px`),this.map&&(u&&""!==u&&this.map.setRegionAnimated(u,!0),t&&t!==this?.map?.mapType&&(this.map.mapType=e.mapType),i&&i!==this.map?._impl?.zoomLevel&&(this.map._impl.zoomLevel=i),l&&l!==this?.map?.rotation&&this.map.setRotationAnimated(Number(l)),a&&o&&(a!==this?.map?.center?.latitude||o!==this?.map?.center?.longitude)&&this.map.setCenterAnimated(new this.mapkit.Coordinate(a,o)),void 0!==n&&n!==this?.map?.showsMapTypeControl&&(this.map.showsMapTypeControl=!!n),void 0!==s&&s!==this?.map?.isRotationEnabled&&(this.map.isRotationEnabled=!!s),r!==this?.map?.showsCompass&&this.map.isRotationEnabled&&(this.map.showsCompass=r||this.mapkit.FeatureVisibility.Adaptive),void 0!==p&&p!==this?.map?.isZoomEnabled&&(this.map.isZoomEnabled=!!p),void 0!==c&&c!==this?.map?.showsZoomControl&&(this.map.showsZoomControl=!!c),void 0!==m&&m!==this?.map?.isScrollEnabled&&(this.map.isScrollEnabled=!!m),d!==this?.map?.showsScale&&(this.map.showsScale=d||this.mapkit.FeatureVisibility.Adaptive))}}const E=Object.keys(mapkit.Map.MapTypes).map((e=>({label:"MutedStandard"===e?(0,m.__)("Muted","maps-block-apple"):e,value:mapkit.Map.MapTypes[e]}))),_=Object.keys(mapkit.FeatureVisibility).map((e=>({label:e,value:mapkit.FeatureVisibility[e]})));function w(){const[e,t]=(0,d.useState)(""),[a,o]=(0,d.useState)(""),[i,n]=(0,d.useState)(""),[s,r]=(0,d.useState)(!1),u=(0,l.useSelect)((e=>e("core").getEntityRecord("root","site")),[]);return(0,d.useEffect)((()=>{if(u){const{maps_block_apple:{private_key:e,team_id:a,key_id:l}}=u;t(e),o(l),n(a)}}),[u]),(0,p.createElement)(p.Fragment,null,(0,p.createElement)(c.TextareaControl,{label:(0,m.__)("Please enter your Private Key","maps-block-apple"),readOnly:s,name:"private_key",value:e,onChange:e=>t(e)}),(0,p.createElement)(c.TextControl,{label:(0,m.__)("Please enter your Key ID","maps-block-apple"),readOnly:s,name:"key_id",value:a,onChange:e=>o(e)}),(0,p.createElement)(c.TextControl,{label:(0,m.__)("Please enter your Team ID","maps-block-apple"),readOnly:s,name:"team_id",value:i,onChange:e=>n(e)}),(0,p.createElement)(c.Button,{isPrimary:!0,disabled:s,isBusy:s,onClick:()=>{r(!0),(0,l.dispatch)("core").saveEntityRecord("root","site",{maps_block_apple:{private_key:e,team_id:i,key_id:a}}).then((({maps_block_apple:{private_key:e,team_id:a,key_id:l}})=>{t(e),o(l),n(a),r(!1),mapkit.dispatchEvent(new CustomEvent("reinitialize"))})).catch((e=>{(0,l.dispatch)("core/notices").createErrorNotice(e.message,{isDismissible:!0,type:"snackbar"}),r(!1)}))}},(0,m.__)("Confirm MapKit Credentials","maps-block-apple")))}function v(e){const{attributes:{mapType:t,height:a,zoom:o,showsMapTypeControl:l,isRotationEnabled:i,showsCompass:n,isZoomEnabled:s,showsZoomControl:r,isScrollEnabled:d,showsScale:u},setAttributes:h}=e;return(0,p.createElement)(c.PanelBody,{title:(0,m.__)("Display Settings","maps-block-apple")},(0,p.createElement)(c.__experimentalToggleGroupControl,{label:(0,m.__)("Map Type","maps-block-apple"),isBlock:!0,isAdaptiveWidth:!0,value:t,onChange:e=>h({mapType:e})},E.map((e=>(0,p.createElement)(c.__experimentalToggleGroupControlOption,{...e,key:e.value})))),(0,p.createElement)(c.ToggleControl,{label:(0,m.__)("Show Map Type Control","maps-block-apple"),checked:l,onChange:e=>h({showsMapTypeControl:e})}),(0,p.createElement)(c.RangeControl,{label:(0,m.__)("Zoom","maps-block-apple"),value:o,onChange:e=>h({zoom:e}),min:0,max:20,step:.5}),(0,p.createElement)(c.ToggleControl,{label:(0,m.__)("Zoom Enabled","maps-block-apple"),checked:s,onChange:e=>h({isZoomEnabled:e})}),s&&(0,p.createElement)(c.ToggleControl,{label:(0,m.__)("Show Zoom Control","maps-block-apple"),checked:r,onChange:e=>h({showsZoomControl:e})}),(0,p.createElement)(c.ToggleControl,{label:(0,m.__)("Rotation Enabled","maps-block-apple"),checked:i,onChange:e=>h({isRotationEnabled:e})}),i&&(0,p.createElement)(c.__experimentalToggleGroupControl,{label:(0,m.__)("Compass Visibility","maps-block-apple"),isBlock:!0,value:n,onChange:e=>h({showsCompass:e})},_.map((e=>(0,p.createElement)(c.__experimentalToggleGroupControlOption,{...e,key:e.value})))),(0,p.createElement)(c.ToggleControl,{label:(0,m.__)("Scroll Enabled","maps-block-apple"),checked:d,onChange:e=>h({isScrollEnabled:e})}),(0,p.createElement)(c.__experimentalToggleGroupControl,{label:(0,m.__)("Scale Visibility","maps-block-apple"),value:u,isBlock:!0,onChange:e=>h({showsScale:e})},_.map((e=>(0,p.createElement)(c.__experimentalToggleGroupControlOption,{...e,key:e.value})))),(0,p.createElement)(c.TextControl,{label:(0,m.__)("Height ( pixels )","maps-block-apple"),value:a,onChange:e=>h({height:e})}))}function C(e){const{searchResults:t,setSearchResults:a,setAttributes:o,map:l}=e;if(0===t.length)return null;const i=e=>{const i=t[e];o({address:i.formattedAddress}),l.update({region:i.region}),a([])};return(0,p.createElement)(c.Popover,{focusOnMount:!1,noArrow:!1,position:"bottom right"},(0,p.createElement)(c.NavigableMenu,{style:{width:"250px",margin:"6px"},onNavigate:i},(0,p.createElement)("ul",null,t.map(((e,t)=>(0,p.createElement)("li",{key:e.muid},(0,p.createElement)(c.Button,{onClick:()=>i(t),style:{borderRadius:"4px",textAlign:"start",width:"100%"}},e.formattedAddress)))))))}function f({latitude:e,longitude:t}){return(0,p.createElement)(p.Fragment,null,(0,p.createElement)("p",null,(0,m.__)("Coordinates: ","maps-block-apple"),`${e.toFixed(4)}, ${t.toFixed(4)}`))}function S(e){const{map:t,mapkit:a,attributes:{latitude:o,longitude:l,address:i},setAttributes:n}=e,[s,r]=(0,d.useState)([]),[u,h]=(0,d.useState)([]);if((0,d.useEffect)((()=>{r("")}),[i]),!a)return null;const b=new a.Geocoder,g=(e,t)=>{t.results&&h(t.results)};return(0,p.createElement)(c.PanelBody,{title:(0,m.__)("Location Settings","maps-block-apple")},(0,p.createElement)("div",null,(0,p.createElement)(c.SearchControl,{label:(0,m.__)("Search for a Location","maps-block-apple"),value:s,onChange:e=>{e?b.lookup(e,g):h([]),r(e)}}),(0,p.createElement)(C,{map:t,setAttributes:n,searchResults:u,setSearchResults:h})),(0,p.createElement)(f,{latitude:o,longitude:l}))}function T(e){const{marker:t,update:a}=e,o=["image"],l=e=>{a({...t,glyphImageId:e.id,glyphImage:e.url})};return(0,p.createElement)("div",{className:"maps-block-apple-marker-uploader"},(0,p.createElement)(c.BaseControl,{id:"marker-icon-control",label:(0,m.__)("Marker Icon","maps-block-apple")},(0,p.createElement)(h.MediaUploadCheck,null,(0,p.createElement)(h.MediaUpload,{allowedTypes:o,render:({open:e})=>(0,p.createElement)(c.Button,{className:t.glyphImageId?"editor-post-featured-image__preview":"editor-post-featured-image__toggle",onClick:e},!t.glyphImageId&&(0,m.__)("Choose an icon","maps-block-apple"),t.glyphImageId&&t.glyphImage&&(0,p.createElement)("img",{src:t.glyphImage,alt:(0,m.__)("Marker icon","maps-block-apple")})),onSelect:l,value:t.glyphImageId})),!!t.glyphImageId&&(0,p.createElement)(h.MediaUploadCheck,null,t.glyphImage&&(0,p.createElement)(h.MediaUpload,{onSelect:l,allowedTypes:o,render:({open:e})=>(0,p.createElement)(c.Button,{onClick:e,variant:"secondary",className:"replace-marker-icon"},(0,m.__)("Replace icon","maps-block-apple"))}),(0,p.createElement)(c.Button,{className:"remove-marker-icon",onClick:()=>{a({...t,glyphImageId:void 0,glyphImage:void 0})},variant:"link",isDestructive:!0},(0,m.__)("Remove icon","maps-block-apple")))))}function M(e){const{marker:t,remove:a,update:o}=e,i=(0,l.useSelect)((e=>e("core/block-editor").getSettings().colors));return(0,p.createElement)(c.PanelBody,{title:t.title,className:"marker-edit",icon:"location",initialOpen:!1},(0,p.createElement)(c.TextControl,{label:(0,m.__)("Title","maps-block-apple"),value:t.title,onChange:e=>o({...t,title:e})}),(0,p.createElement)(c.TextControl,{label:(0,m.__)("Subtitle","maps-block-apple"),value:t.subtitle,onChange:e=>o({...t,subtitle:e})}),(0,p.createElement)(c.PanelRow,null,(0,p.createElement)("label",{htmlFor:"marker-color-control"},(0,m.__)("Marker Color","maps-block-apple")),(0,p.createElement)(c.ColorIndicator,{id:"marker-color-control",colorValue:t.color})),(0,p.createElement)(c.ColorPalette,{value:t.color,colors:i,onChange:e=>o({...t,color:e})}),(0,p.createElement)(c.PanelRow,null,(0,p.createElement)("label",{htmlFor:"glyph-color-control"},(0,m.__)("Icon Color","maps-block-apple")),(0,p.createElement)(c.ColorIndicator,{id:"glyph-color-control",colorValue:t.glyphColor})),(0,p.createElement)(c.ColorPalette,{value:t.glyphColor,colors:i,onChange:e=>o({...t,glyphColor:e})}),(0,p.createElement)(T,{marker:t,update:o}),(0,p.createElement)(c.PanelRow,null,(0,p.createElement)(f,{latitude:t.latitude,longitude:t.longitude})),(0,p.createElement)(c.PanelRow,null,(0,p.createElement)(c.Button,{isLink:!0,icon:"no",isDestructive:!0,onClick:a},(0,m.__)("Remove Marker","maps-block-apple"))))}function A(e){const{attributes:{markers:t},setAttributes:a}=e,o=e=>o=>{const l=[...t];l[e]=o,a({markers:l})},l=e=>()=>{const o=[...t];o.splice(e,1),a({markers:o})};return t.length?(0,p.createElement)(c.PanelBody,{title:(0,m.__)("Marker Settings","apple-maps-wordpress")},t.map(((e,t)=>(0,p.createElement)(M,{key:t,marker:e,update:o(t),remove:l(t)}))),(0,p.createElement)(c.Tip,null,(0,m.__)("You can move a marker by long pressing on it.","maps-block-apple"))):null}function R(e){const{isAuthenticated:t}=e;return t?(0,p.createElement)(h.InspectorControls,null,(0,p.createElement)(S,{...e}),(0,p.createElement)(v,{...e}),(0,p.createElement)(A,{...e})):(0,p.createElement)(h.InspectorControls,null,(0,p.createElement)(c.PanelBody,null,(0,p.createElement)("p",null,(0,m.__)("You need to confirm your access to Apple Maps before you can continue.","maps-block-apple"))))}function I({children:e,fallback:t}){return(0,l.useSelect)((e=>e("core").canUser("update","settings")))?e:t||null}const z=function(){return(0,p.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"none",viewBox:"0 0 40 52"},(0,p.createElement)("path",{fill:"#333",fillRule:"evenodd",d:"M37.15 9.802c0 4.936-3.698 9.05-8.46 9.709v11.854l-1.304 3.92-1.303-3.92V19.521c-4.8-.626-8.536-4.757-8.536-9.72 0-5.39 4.41-9.801 9.802-9.801 5.39 0 9.801 4.41 9.801 9.802zm-15.224-2.38c.74.633 2.088.274 3.01-.802.922-1.077 1.068-2.464.327-3.098-.74-.634-2.088-.275-3.01.802-.921 1.076-1.068 2.463-.327 3.097z",clipRule:"evenodd"}),(0,p.createElement)("path",{fill:"#333",d:"M12.85 25l11.277 3.776v2.589l3.26 8.821 3.258-8.821v-2.483L40 25v21.736l-12.124 4.93-15.026-4.93L0 51.666V30.032L12.85 25z"}))},x={top:!1,right:!1,bottom:!0,left:!1,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1};function B({onResizeStart:e,onResize:t,onResizeStop:a,...o}){const[l,i]=(0,d.useState)(!1);return(0,p.createElement)(c.ResizableBox,{style:{position:"absolute",top:0,left:0,right:0,bottom:0},className:"apple-maps-block__resize-container "+(l?"is-resizing":""),enable:x,onResizeStart:(a,o,l)=>{e(l.clientHeight),t(l.clientHeight)},onResize:(e,a,o)=>{t(o.clientHeight),l||i(!0)},onResizeStop:(e,t,o)=>{a(o.clientHeight),i(!1)},minHeight:100,...o})}const P=(0,d.memo)((e=>{const{map:t,isAuthenticated:a,clientId:o,setAttributes:l,setMap:i,mapkit:n}=e,s=!!t,r=(0,u.useRefEffect)((e=>{if(n)return a&&!s&&i(new k(e,o,l)),()=>{s&&(t.destroy(),i(null))}}),[n,a,t,o,l]);return(0,p.createElement)("div",{ref:r})})),N=JSON.parse('{"name":"tenup/maps-block-apple","title":"Apple Maps","category":"embed","description":"Add an Apple Map to your site.","apiVersion":3,"keywords":["apple","map","apple map"],"attributes":{"address":{"type":"string","default":""},"height":{"type":"string","default":"450"},"latitude":{"type":"number","default":51.48762585296625},"longitude":{"type":"number","default":-0.1326724377053381},"rotation":{"type":"number","default":0},"zoom":{"type":"number","default":15},"mapType":{"type":"string","default":"standard"},"showsMapTypeControl":{"type":"boolean","default":true},"isRotationEnabled":{"type":"boolean","default":true},"showsCompass":{"type":"string","default":"adaptive"},"isZoomEnabled":{"type":"boolean","default":true},"showsZoomControl":{"type":"boolean","default":true},"isScrollEnabled":{"type":"boolean","default":true},"showsScale":{"type":"string","default":"adaptive"},"markers":{"type":"array","default":[]}},"example":{"attributes":{"latitude":51.48762585296625,"longitude":-0.1326724377053381}},"supports":{"align":["wide","full"],"spacing":{"margin":true},"html":false},"editorScript":"maps-block-apple-block","viewScript":"maps-block-apple-frontend","editorStyle":"file:build/index.css"}'),{Map:L,FeatureVisibility:V}=mapkit,O=[{attributes:{...N.attributes,mapType:{type:"string",default:L.MapTypes.Standard},showsCompass:{type:"string",default:V.Adaptive},showsScale:{type:"string",default:V.Adaptive}},save(e){const{attributes:{mapType:t,height:a,latitude:o,longitude:l,rotation:i,zoom:n,showsMapTypeControl:s,isRotationEnabled:r,showsCompass:c,isZoomEnabled:m,showsZoomControl:d,isScrollEnabled:u,showsScale:b,markers:g}}=e,y=h.useBlockProps.save();return(0,p.createElement)("div",{...y,"data-map-type":t,"data-latitude":o,"data-longitude":l,"data-rotation":i,"data-zoom":n,"data-shows-map-type-control":s,"data-is-rotation-enabled":r,"data-shows-compass":c,"data-is-zoom-enabled":m,"data-shows-zoom-control":d,"data-is-scroll-enabled":u,"data-shows-scale":b,style:{height:`${a}px`}},g.map(((e,t)=>(0,p.createElement)("div",{key:t,className:"marker-annotation","data-latitude":e.latitude,"data-longitude":e.longitude,"data-title":e.title,"data-subtitle":e.subtitle,"data-color":e.color,"data-glyph-color":e.glyphColor}))))}}],{Map:Z,FeatureVisibility:F}=mapkit;(0,o.registerBlockType)(N,{icon:z,attributes:{...N.attributes,mapType:{type:"string",default:Z.MapTypes.Standard},showsCompass:{type:"string",default:F.Adaptive},showsScale:{type:"string",default:F.Adaptive}},edit:function(e){const{attributes:t,setAttributes:a,clientId:o,isSelected:i}=e,{height:n,latitude:s,longitude:b,markers:g}=t,[y,E]=(0,d.useState)(null),[_,v]=(0,d.useState)(null),C=!!y,f=(0,l.useSelect)((e=>e(r).isAuthenticated())),[S,T]=(0,d.useState)(!0),{updateAuthenticationStatus:M}=(0,l.useDispatch)(r),{toggleSelection:A}=(0,l.useDispatch)(h.store),x=(0,u.useRefEffect)((e=>{const t=e.ownerDocument.defaultView.mapkit;if(!t)return void v(null);v(t);const a=({status:e})=>{switch(e){case"Initialized":case"Refreshed":T(!1),M(!0)}};t.addEventListener("configuration-change",a);const o=()=>{T(!1),M(!1)};t.addEventListener("error",o);const l=()=>{k.authenticateMap(t)};return t.addEventListener("reinitialize",l),f||l(),()=>{t.removeEventListener("configuration-change",a),t.removeEventListener("error",o),t.removeEventListener("reinitialize",l),v(null)}}));(0,d.useEffect)((()=>{f&&T(!1)}),[f]),(0,d.useEffect)((()=>{f&&C&&y.update(t)}),[t,f,y]);const N=(0,u.useDebounce)((e=>{C&&y.addMarkers(e)}),300);(0,d.useEffect)((()=>N(g)),[g]);const L=(0,h.useBlockProps)({ref:x});return S?(0,p.createElement)("div",{...L},(0,p.createElement)(c.Placeholder,{style:{height:`${n}px`},label:(0,m.__)("Block for Apple Maps","maps-block-apple"),icon:z},(0,p.createElement)(c.Spinner,null))):f?(0,p.createElement)(p.Fragment,null,(0,p.createElement)(h.BlockControls,null,(0,p.createElement)(c.ToolbarGroup,null,(0,p.createElement)(c.ToolbarButton,{icon:"location",title:(0,m.__)("Add Marker","apple-maps-wordpress"),onClick:()=>{a({markers:[...g,{latitude:s,longitude:b,title:"Title",id:Symbol("identifier for the marker")}]})}}))),(0,p.createElement)(R,{...e,isAuthenticated:f,map:y,mapkit:_}),(0,p.createElement)("div",{...L},(0,p.createElement)(B,{onResizeStart:()=>{A(!1)},onResize:e=>{y.update({height:e})},onResizeStop:e=>{a({height:e}),A(!0)},showHandle:i,size:{height:n}}),(0,p.createElement)(P,{map:y,setMap:E,isAuthenticated:f,clientId:o,setAttributes:a,mapkit:_}))):(0,p.createElement)(p.Fragment,null,(0,p.createElement)(R,{...e,isAuthenticated:f,map:y,mapkit:_}),(0,p.createElement)("div",{...L},(0,p.createElement)(c.Placeholder,{style:{minHeight:`${n}px`},label:(0,m.__)("Confirm access to Apple Maps","maps-block-apple"),icon:z,isColumnLayout:!0},(0,p.createElement)(I,{fallback:(0,m.__)("Sorry, you are not allowed to do that. Please talk to your Administrator.","maps-block-apple")},(0,p.createElement)("div",{style:{marginBottom:"1em"}},(0,m.__)("In order to include an Apple Map on your website you need to confirm your MapKit credentials below. Here is documentation on how to get those credentials: ","maps-block-apple"),(0,p.createElement)("a",{href:"https://developer.apple.com/documentation/mapkitjs/setting_up_mapkit_js",target:"_blank",rel:"noopener noreferrer"},(0,m.__)("Instructions for creating your MapKit credentials.","maps-block-apple"))),(0,p.createElement)(w,null)))))},save:function(e){const{attributes:{mapType:t,height:a,latitude:o,longitude:l,rotation:i,zoom:n,showsMapTypeControl:s,isRotationEnabled:r,showsCompass:c,isZoomEnabled:m,showsZoomControl:d,isScrollEnabled:u,showsScale:b,markers:g}}=e,y=h.useBlockProps.save({style:{height:`${a}px`}});return(0,p.createElement)("div",{...y,"data-map-type":t,"data-latitude":o,"data-longitude":l,"data-rotation":i,"data-zoom":n,"data-shows-map-type-control":s,"data-is-rotation-enabled":r,"data-shows-compass":c,"data-is-zoom-enabled":m,"data-shows-zoom-control":d,"data-is-scroll-enabled":u,"data-shows-scale":b},g.map(((e,t)=>(0,p.createElement)("div",{key:t,className:"marker-annotation","data-latitude":e.latitude,"data-longitude":e.longitude,"data-title":e.title,"data-subtitle":e.subtitle,"data-color":e.color,"data-glyph-color":e.glyphColor,"data-glyph-image":e.glyphImage}))))},deprecated:O})})();